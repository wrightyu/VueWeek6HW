import{M as k}from"./bootstrap.esm-726e85d3.js";import{_ as b,o as d,c as l,d as t,n as P,F as h,f as y,j as U,t as m,h as n,i as c,k as M,a as $,r as f,b as v}from"./index-01b5661e.js";const C={props:["pages","getProduct"]},V={"aria-label":"Page navigation example"},N={class:"pagination"},A=t("span",{"aria-hidden":"true"},"«",-1),I=[A],B=["onClick"],L=t("span",{"aria-hidden":"true"},"»",-1),E=[L];function S(e,s,a,_,u,i){return d(),l("nav",V,[t("ul",N,[t("li",{class:P(["page-item",{disabled:!a.pages.has_pre}])},[t("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:s[0]||(s[0]=o=>a.getProduct(a.pages.current_page-1))},I)],2),(d(!0),l(h,null,y(a.pages.total_pages,o=>(d(),l("li",{class:P(["page-item",{active:o===a.pages.current_page}]),key:o+"page"},[t("a",{class:"page-link",href:"#",onClick:U(p=>e.$emit("change-page",o),["prevent"])},m(o),9,B)],2))),128)),t("li",{class:P(["page-item",{disabled:!a.pages.has_next}])},[t("a",{class:"page-link",href:"#","aria-label":"Next",onClick:s[1]||(s[1]=o=>a.getProduct(a.pages.current_page+1))},E)],2)])])}const T=b(C,[["render",S]]),z={props:["temp-product","update-product","is-new","create-images"]},D={class:"modal-dialog modal-xl"},F={class:"modal-content border-0"},J={class:"modal-header bg-dark text-white"},O={id:"productModalLabel",class:"modal-title"},j={key:0},H={key:1},W=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),q={class:"modal-body"},G={class:"row"},K={class:"col-sm-4"},Q={class:"mb-2"},R={class:"mb-3"},X=t("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),Y=["src","alt"],Z={key:0},x={class:"mb-3"},tt=t("label",{for:"imageUrl",class:"form-label"}," 圖片網址 ",-1),et=["onUpdate:modelValue"],st=["src","alt"],ot={key:0},dt={key:1},lt={key:1},at={class:"col-sm-8"},it={class:"mb-3"},nt=t("label",{for:"title",class:"form-label"},"標題",-1),rt={class:"row"},ct={class:"mb-3 col-md-6"},ut=t("label",{for:"category",class:"form-label"},"分類",-1),pt={class:"mb-3 col-md-6"},mt=t("label",{for:"price",class:"form-label"},"單位",-1),ht={class:"row"},bt={class:"mb-3 col-md-6"},_t=t("label",{for:"origin_price",class:"form-label"},"原價",-1),gt={class:"mb-3 col-md-6"},Pt=t("label",{for:"price",class:"form-label"},"售價",-1),ft=t("hr",null,null,-1),vt={class:"mb-3"},$t=t("label",{for:"description",class:"form-label"},"產品描述",-1),yt={class:"mb-3"},kt=t("label",{for:"content",class:"form-label"},"說明內容",-1),wt={class:"mb-3"},Ut={class:"form-check"},Mt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Ct={class:"modal-footer"},Vt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Nt(e,s,a,_,u,i){return d(),l("div",D,[t("div",F,[t("div",J,[t("h5",O,[e.isNew?(d(),l("span",j,"新增產品")):(d(),l("span",H,"編輯產品"))]),W]),t("div",q,[t("div",G,[t("div",K,[t("div",Q,[t("div",R,[X,n(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":s[0]||(s[0]=o=>e.tempProduct.imageUrl=o)},null,512),[[c,e.tempProduct.imageUrl]]),t("img",{class:"img-fluid",src:e.tempProduct.imageUrl,alt:e.tempProduct.title},null,8,Y)])]),Array.isArray(e.tempProduct.imagesUrl)?(d(),l("div",Z,[(d(!0),l(h,null,y(e.tempProduct.imagesUrl,(o,p)=>(d(),l("div",{class:"mb-1",key:p},[t("div",x,[tt,n(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":g=>e.tempProduct.imagesUrl[p]=g},null,8,et),[[c,e.tempProduct.imagesUrl[p]]])]),t("img",{class:"img-fluid",src:o,alt:`多圖之${p+1}`},null,8,st)]))),128)),!e.tempProduct.imagesUrl.length||e.tempProduct.imagesUrl[e.tempProduct.imagesUrl.length-1]?(d(),l("div",ot,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:s[1]||(s[1]=o=>e.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(d(),l("div",dt,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:s[2]||(s[2]=o=>e.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):(d(),l("div",lt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:s[3]||(s[3]=(...o)=>e.createImages&&e.createImages(...o))}," 新增圖片 ")]))]),t("div",at,[t("div",it,[nt,n(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":s[4]||(s[4]=o=>e.tempProduct.title=o)},null,512),[[c,e.tempProduct.title]])]),t("div",rt,[t("div",ct,[ut,n(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":s[5]||(s[5]=o=>e.tempProduct.category=o)},null,512),[[c,e.tempProduct.category]])]),t("div",pt,[mt,n(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":s[6]||(s[6]=o=>e.tempProduct.unit=o)},null,512),[[c,e.tempProduct.unit]])])]),t("div",ht,[t("div",bt,[_t,n(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":s[7]||(s[7]=o=>e.tempProduct.origin_price=o)},null,512),[[c,e.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",gt,[Pt,n(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":s[8]||(s[8]=o=>e.tempProduct.price=o)},null,512),[[c,e.tempProduct.price,void 0,{number:!0}]])])]),ft,t("div",vt,[$t,n(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":s[9]||(s[9]=o=>e.tempProduct.description=o)},`
              `,512),[[c,e.tempProduct.description]])]),t("div",yt,[kt,n(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":s[10]||(s[10]=o=>e.tempProduct.content=o)},`
              `,512),[[c,e.tempProduct.content]])]),t("div",wt,[t("div",Ut,[n(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":s[11]||(s[11]=o=>e.tempProduct.is_enabled=o)},null,512),[[M,e.tempProduct.is_enabled]]),Mt])])])])]),t("div",Ct,[Vt,t("button",{type:"button",class:"btn btn-primary",onClick:s[12]||(s[12]=(...o)=>e.updateProduct&&e.updateProduct(...o))}," 確認 ")])])])}const At=b(z,[["render",Nt]]),It={props:["del-product","temp-product"]},Bt={class:"modal-dialog"},Lt={class:"modal-content border-0"},Et=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),St={class:"modal-body"},Tt={class:"text-danger"},zt={class:"modal-footer"},Dt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ft(e,s,a,_,u,i){return d(),l("div",Bt,[t("div",Lt,[Et,t("div",St,[$(" 是否刪除 "),t("strong",Tt,m(e.tempProduct.title),1),$(" 商品(刪除後將無法恢復)。 ")]),t("div",zt,[Dt,t("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=(...o)=>e.delProduct&&e.delProduct(...o))}," 確認刪除 ")])])])}const Jt=b(It,[["render",Ft]]),Ot={data(){return{productModal:"",delProductModal:"",baseUrl:"https://vue3-course-api.hexschool.io/v2",userPath:"wrightyu",products:[],tempProduct:{imagesUrl:[]},isNew:!1,page:{}}},methods:{checkAdmin(){this.$http.post(`${this.baseUrl}/api/user/check`).then(e=>{alert("successfully checked!"),this.getProducts()}).catch(e=>{alert(e.data.message),window.location="index.html"})},getProducts(e=1){this.$http.get(`${this.baseUrl}/api/${this.userPath}/admin/products/?page=${e}`).then(s=>{this.products=s.data.products,this.page=s.data.pagination}).catch(s=>{alert(s.data.message)})},showModal(e,s){e==="new"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.productModal.show()):e==="edit"?(this.tempProduct=JSON.parse(JSON.stringify(s)),this.isNew=!1,this.productModal.show()):e==="del"&&(this.tempProduct={...s},this.delProductModal.show())},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")},updateProduct(){let e=`${this.baseUrl}/api/${this.userPath}/admin/product`,s="post";this.isNew||(e=`${this.baseUrl}/api/${this.userPath}/admin/product/${this.tempProduct.id}`,s="put"),this.$http[s](e,{data:this.tempProduct}).then(a=>{alert(a.data.message),this.productModal.hide(),this.getProducts()}).catch(a=>{alert(a.data.message)})},delProduct(){this.$http.delete(`${this.baseUrl}/api/${this.userPath}/admin/product/${this.tempProduct.id}`).then(e=>{alert(e.data.message),this.delProductModal.hide(),this.getProducts()}).catch(e=>{alert(e.data.message)})}},components:{pagination:T,productModal:At,delProductModal:Jt},mounted(){this.$http.defaults.headers.common.Authorization=document.cookie.replace(/(?:(?:^|.*;\s*)wrightyuVueHW3Token\s*=\s*([^;]*).*$)|^.*$/,"$1"),this.checkAdmin(),this.productModal=new k(document.getElementById("productModal")),this.delProductModal=new k(document.getElementById("delProductModal"))}},jt={class:"container"},Ht={class:"text-end mt-4"},Wt={class:"table mt-4"},qt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Gt={class:"text-end"},Kt={class:"text-end"},Qt={key:0,class:"text-success"},Rt={key:1},Xt={class:"btn-group"},Yt=["onClick"],Zt=["onClick"],xt={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},te={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"};function ee(e,s,a,_,u,i){const o=f("pagination"),p=f("product-modal"),g=f("del-product-modal");return d(),l(h,null,[$(" 後台產品列表 "),t("div",jt,[t("div",Ht,[t("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=r=>i.showModal("new"))},"建立新的產品")]),t("table",Wt,[qt,t("tbody",null,[(d(!0),l(h,null,y(u.products,r=>(d(),l("tr",{key:r.id},[t("td",null,m(r.category),1),t("td",null,m(r.title),1),t("td",Gt,m(r.origin_price),1),t("td",Kt,m(r.price),1),t("td",null,[r.is_enabled?(d(),l("span",Qt,"啟用")):(d(),l("span",Rt,"未啟用"))]),t("td",null,[t("div",Xt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:w=>i.showModal("edit",r)}," 編輯 ",8,Yt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:w=>i.showModal("del",r)}," 刪除 ",8,Zt)])])]))),128))])]),v(o,{pages:u.page,"get-product":i.getProducts,onChangePage:i.getProducts},null,8,["pages","get-product","onChangePage"])]),t("div",xt,[v(p,{"temp-product":u.tempProduct,"update-product":i.updateProduct,"is-new":u.isNew,"create-images":i.createImages},null,8,["temp-product","update-product","is-new","create-images"])],512),t("div",te,[v(g,{"del-product":i.delProduct,"temp-product":u.tempProduct},null,8,["del-product","temp-product"])],512)],64)}const de=b(Ot,[["render",ee]]);export{de as default};
