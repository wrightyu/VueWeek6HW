import{_ as I,o as l,c as r,a as u,d as t,F as p,f as g,g as m,t as n,h as f,v as b}from"./index-39c580c2.js";const{VITE_APP_URL:c,VITE_APP_PATH:i}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"wrightyu",BASE_URL:"/VueWeek6HW/",MODE:"production",DEV:!1,PROD:!0},x={data(){return{products:[],pointedProductId:"",cart:{},loadingItemId:"",productLoadingClassObject:{fas:!0,"fa-spinner":!0,"fa-pulse":!0},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){this.$http.get(`${c}/v2/api/${i}/cart`).then(e=>{this.cart=e.data.data}).catch(e=>{alert(e)})},updateCartItem(e){const o={product_id:e.product.id,qty:e.qty};this.loadingItemId=e.id,this.$http.put(`${c}/v2/api/${i}/cart/${e.id}`,{data:o}).then(h=>{this.getCarts(),this.loadingItemId=""}).catch(h=>{alert(h)})},deleteItem(e){this.loadingItemId=e.id,this.$http.delete(`${c}/v2/api/${i}/cart/${e.id}`).then(o=>{this.getCarts(),this.loadingItemId=""}).catch(o=>{alert(o)})},deleteAll(){this.$http.delete(`${c}/v2/api/${i}/carts`).then(e=>{alert("成功清空購物車")}).catch(e=>{alert(e)})},createOrder(){this.$http.post(`${c}/v2/api/${i}/order`,{data:this.form}).then(e=>{alert(e.data.message),this.$refs.form.resetForm(),this.getCarts()}).catch(e=>{alert(e)})},isPhone(e){return/^(09)[0-9]{8}$/.test(e)?!0:"需要正確的電話號碼"}},mounted(){this.getCarts()}},$={class:"table align-middle"},v=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),C=["onClick","disabled"],y={key:0,class:"fas fa-spinner fa-pulse"},P=t("div",{class:"text-success"},"已套用優惠券",-1),V={class:"input-group input-group-sm"},k={class:"input-group mb-3"},A=["onUpdate:modelValue","onChange","disabled"],E=["value"],T={class:"input-group-text",id:"basic-addon2"},D={class:"text-end"},L=t("small",{class:"text-success"},"折扣價：",-1),N=t("td",{colspan:"3",class:"text-end"},"總計",-1),U={class:"text-end"},q=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),w={class:"text-end text-success"};function B(e,o,h,O,a,_){return l(),r(p,null,[u(" 這是購物車 "),t("table",$,[v,t("tbody",null,[a.cart.carts?(l(!0),r(p,{key:0},g(a.cart.carts,s=>(l(),r("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:d=>_.deleteItem(s),disabled:s.id===a.loadingItemId},[s.id===a.loadingItemId?(l(),r("i",y)):m("",!0),u(" x ")],8,C)]),t("td",null,[u(n(s.product.title)+" ",1),P]),t("td",null,[t("div",V,[t("div",k,[f(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":d=>s.qty=d,onChange:d=>_.updateCartItem(s),disabled:s.id===a.loadingItemId},[(l(),r(p,null,g(20,d=>t("option",{value:d,key:`${d}randomString`},n(d),9,E)),64))],40,A),[[b,s.qty]]),t("span",T,n(s.product.unit),1)])])]),t("td",D,[L,u(" "+n(s.total),1)])]))),128)):m("",!0)]),t("tfoot",null,[t("tr",null,[N,t("td",U,n(a.cart.total),1)]),t("tr",null,[q,t("td",w,n(a.cart.final_total),1)])])])],64)}const S=I(x,[["render",B]]);export{S as default};
